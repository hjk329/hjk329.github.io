---
title:  "Next.jsì˜ Routing"
categories: 
  - Next.js
tags:
  - Routing
  - Router
  - Dynamic Routing
  - ë™ì  ë¼ìš°íŒ…
  - Shallow Routing
  - location.replace()
  - router.push()
  - getServerSideProps
toc: true
toc_sticky: true
toc_label: "Next.jsì˜ Routing"
share: true
---

Next.jsì˜ Routingì„ ì•Œì•„ë³´ì! ğŸ’Œ  

### ë¼ìš°íŒ…ì´ë€?
ë¼ìš°íŒ…ì€ ë„¤íŠ¸ì›Œí¬ ìš©ì–´ë¡œì„œ ë„¤íŠ¸ì›Œí¬ìƒì˜ ì£¼ì†Œë¡œ ì´ë™í•˜ì—¬ í•´ë‹¹ ì£¼ì†Œì— ì—°ê²°ë˜ì–´ìˆëŠ” ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ì¼ë ¨ì˜ ê³¼ì •ì„ ì˜ë¯¸í•œë‹¤.  
ë¼ìš°í„°ëŠ” ë¼ìš°íŒ…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ì¥ì¹˜ì´ë‹¤.    


ë¦¬ì•¡íŠ¸ì—ì„œëŠ” ë¼ìš°í„°ë¥¼ ì œê³µí•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— `react-router-dom`ì´ë¼ëŠ” íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•˜ì—¬ ì‚¬ìš©í•œë‹¤.    



```javascript
import React from 'react';
import { Switch, Route } from 'react-router-dom';

import Home from './pages/Home';
import HeaderContainer from './views/shared/containers/HeaderContainer';
import { GlobalStyle } from './styled/GlobalStyle';
import Watch from './pages/Watch';
import Search from './pages/Search';
import SidebarContainer from './views/shared/containers/SidebarContainer';
import SidebarGuide from './views/shared/components/Sidebar/components/SidebarGuide';

const App = () => (
  <Container>
    <GlobalStyle />
    <HeaderContainer />
    <SidebarContainer />
    <Template>
      <SidebarGuide />
      <Main>
        <Switch>
          <Route exact path="/" component={Home} />
          <Route exact path="/watch/:id" component={Watch} />
          <Route exact path="/results/:query" component={Search} />
        </Switch>
      </Main>
    </Template>
  </Container>
)

const Template = styled.div`
  display: flex;
`;

const Main = styled.div`
  flex: 1;
`;
export default App;
```

ë¦¬ì•¡íŠ¸ë¡œ ìœ íŠœë¸Œ ì›¹ ì‚¬ì´íŠ¸ë¥¼ í´ë¡  ì½”ë”©í•´ë³¸ ì ì´ ìˆëŠ”ë° (`react-router-dom` v6 ì´ì „ì— ì‘ì„±í•œ ì½”ë“œì…ë‹ˆë‹¤)   
ìœ„ì™€ ê°™ì´ ê° ì»´í¬ë„ŒíŠ¸ë¥¼ `Route`ë¼ëŠ” íƒœê·¸ë¡œ ê°ì‹¸ì„œ pathë¥¼ ì§€ì •í•´ì£¼ì—ˆë‹¤.  



Next.jsê°€ `pages` (í˜¹ì€ `src/pages`) í´ë” ì•„ë˜ì— íŒŒì¼ì„ ì¶”ê°€í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ê° ì»´í¬ë„ŒíŠ¸ì— URLì„ ë¶€ì—¬í•˜ëŠ” ê²ƒê³¼ í¬ê²Œ ë‹¤ë¥´ë‹¤ ğŸ‘€  
ì´ëŸ¬í•œ ì°¨ì´ì ì´ ë¦¬ì•¡íŠ¸ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬, Next.jsëŠ” í”„ë ˆì„ì›Œí¬ë¼ê³  í•˜ëŠ” ê·¼ê±°ë¼ê³  ìƒê°í•œë‹¤.    



ë¦¬ì•¡íŠ¸ëŠ” ë¼ìš°í„°ë¥¼ ì„¤ì •í•˜ê¸° ìœ„í•´ ê°œë°œìê°€ ì§ì ‘ ë¼ìš°í„°ì™€ ê´€ë ¨í•œ ì½”ë“œë¥¼ ì‘ì„±í•˜ê³  í•´ë‹¹ ì½”ë“œê°€ í˜¸ì¶œë˜ì–´ URLì„ ë¶„ê¸°ì²˜ë¦¬í•´ì¤€ë‹¤.  
ë°˜ë©´ì— Next.jsëŠ” í•´ë‹¹ í”„ë ˆì„ì›Œí¬ì—ì„œ ì •í•´ë‘” ë°©ì‹ëŒ€ë¡œ í˜ì´ì§€ íŒŒì¼ì„ ìƒì„±í•˜ë©´ í•´ë‹¹ íŒŒì¼ì´ ë¼ìš°í„° ì—­í• ì„ í•œë‹¤. (ì œì–´ì˜ ì—­ì „ì´ ë°œìƒí•œë‹¤.)    




***ì°¸ê³ ! `pages` vs `src/pages`***
`pages` í´ë”ê°€ `src/pages` í´ë”ë³´ë‹¤ ìš°ì„ ê¶Œì„ ê°–ëŠ”ë‹¤.  
ì¦‰, ë‘ í´ë”ê°€ ëª¨ë‘ ì¡´ì¬í•˜ëŠ” ê²½ìš° `pages` í´ë”ì—ì„œ ì‘ì„±í•œ ì½”ë“œê°€ ìš°ì„ ì ìœ¼ë¡œ ì ìš©ë˜ê³ , `src/pages` í´ë” ë‚´ë¶€ëŠ” ë¬´ì‹œëœë‹¤.    




### Next.js ì—ì„œ ìƒì„±í•œ í˜ì´ì§€ íŒŒì¼ì€ ì•„ë˜ì™€ ê°™ì´ ë¼ìš°íŒ…ëœë‹¤.  

1. Index Routes

- `pages/index.js` â†’ `/`
- `pages/blog/index.js` â†’ `/blog`

2. Nested Routes
- `pages/blog/first-post.js` â†’ `/blog/first-post`
- `pages/dashboard/settings/username.js` â†’ `/dashboard/settings/username`

3. Dynamic Routes
- `pages/blog/[slug].js` â†’ `/blog/:slug (/blog/hello-world)`
- `pages/[username]/settings.js` â†’ `/:username/settings (/foo/settings)`
- `pages/post/[...all].js` â†’ `/post/* (/post/2020/id/title)`

router ê°ì²´ì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ì„œëŠ” `useRouter`ë¼ëŠ” í›…ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤.  
í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸ê°„ì˜ ì—°ê²°ì€ `Link` íƒœê·¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.  


### ë™ì  ë¼ìš°íŒ… (Dynamic Routing)
í•­ìƒ ë¯¸ë¦¬ ì •ì˜ëœ ê²½ë¡œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤.  
ì˜ˆë¥¼ ë“¤ì–´, ë¸”ë¡œê·¸ ê²Œì‹œë¬¼ì˜ ê²½ë¡œëŠ” `/blog/1`, `/blog/2` â€¦ ì™€ ê°™ì„í…ë° ëª¨ë“  ê²½ë¡œì— ëŒ€í•´ ë¯¸ë¦¬ ì •ì˜í•˜ê±°ë‚˜ í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸ë¥¼ ìƒì„±í•˜ëŠ” ì¼ì€ êµ‰ì¥íˆ ë¹„íš¨ìœ¨ì ì´ê³ , ì •í™•í•˜ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤.    




ì´ë•Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë™ì  ë¼ìš°íŒ…ì´ë‹¤.  
í˜ì´ì§€ íŒŒì¼ì„ ìƒì„±í• ë•Œ ëŒ€ê´„í˜¸ë¥¼ ì¶”ê°€í•˜ë©´ í•´ë‹¹ í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸ëŠ” ë™ì ìœ¼ë¡œ ë¼ìš°íŒ…ëœë‹¤.  

- `pages/post/[pid].js`

```javascript
import { useRouter } from 'next/router'

const Post = () => {
  const router = useRouter()
  const { pid } = router.query

  return <p>Post: {pid}</p>
}

export default Post
```

ì´ë•Œ query ê°ì²´ëŠ” ì•„ë˜ì™€ ê°™ì€ ê°’ì„ ê°€ì§„ë‹¤.  
```
{ "pid": "abc" }
```

- `/post/abc?foo=bar`

```
{"pid": "abc", "foo": "bar"}
```

- `pages/post/[pid]/[comment].jsì— ëŒ€í•œ ê²½ë¡œê°€ /post/abc/a-commentì¸ ê²½ìš°`

```
{ "pid": "abc", "comment": "a-comment" }
```

í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œì—ì„œ ë™ì  ê²½ë¡œì— ëŒ€í•´ ì ‘ê·¼í•˜ê¸° ìœ„í•´ì„œëŠ” `next/link`ê°€ ì‚¬ìš©ëœë‹¤.  
```javascript
import Link from 'next/link'

function Home() {
  return (
    <ul>
      <li>
        <Link href="/post/abc">Go to pages/post/[pid].js</Link>
      </li>
      <li>
        <Link href="/post/abc?foo=bar">Also goes to pages/post/[pid].js</Link>
      </li>
      <li>
        <Link href="/post/abc/a-comment">
          Go to pages/post/[pid]/[comment].js
        </Link>
      </li>
    </ul>
  )
}

export default Home
```

ì´ì™¸ì—ë„ `router.push` ê°™ì€ ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆë‹¤!  






#### ëª¨ë“  ê²½ë¡œ ìºì¹˜í•˜ê¸° (Catch All Routes)
ëŒ€ê´„í˜¸ ì•ˆì— `...`ë¥¼ ì¶”ê°€í•˜ë©´ ëª¨ë“  ê²½ë¡œë¥¼ ìºì¹˜í•  ìˆ˜ ìˆë‹¤.  

ì˜ˆë¥¼ ë“¤ì–´, `pages/post/[...slug].js` ëŠ” `post/a` ë¿ë§Œ ì•„ë‹ˆë¼, `post/a/b`, `post/a/b/c`, `post/a/b/c/d` ë“± ëª¨ë“  ê²½ë¡œë¥¼ ìºì¹˜í•  ìˆ˜ ìˆë‹¤.  
query ê°ì²´ ì•ˆì— slugë¼ëŠ” í”„ë¡œí¼í‹°ëŠ” ë°°ì—´ì´ë©°, ì•„ë˜ì™€ ê°™ì€ ê°’ì„ ê°€ì§„ë‹¤.  

```javascript
import { useRouter } from "next/router";

const Post = () => {
    const router = useRouter();
    const {slug} = router.query;
    console.log(slug)
    return <h1>Post</h1>
}

export default Post;
```
<br><br>


<img width="672" alt="image" src="https://user-images.githubusercontent.com/84058944/213975470-fc687d5c-8f55-4c6f-b1ec-e8d03ec1d696.png">      

<br><br>

<img width="672" alt="image" src="https://user-images.githubusercontent.com/84058944/213975646-a6c2b21c-e8af-4957-b46d-2d5c91fd2332.png">


#### ì„ íƒì ìœ¼ë¡œ ëª¨ë“  ê²½ë¡œ ìºì¹˜í•˜ê¸° (Optional Catch All Routes)
`[[...slug]]` ì´ë ‡ê²Œ ë”ë¸” ë¸Œë¼ì¼“ì„ ì‚¬ìš©í•˜ë©´ Catch All ê²½ë¡œë¥¼ ì„ íƒì ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.  
Catch Allê³¼ì˜ ë‹¤ë¥¸ ì ì€ ë§¤ê°œë³€ìˆ˜ê°€ ì—†ëŠ” ê²½ë¡œë„ ì¼ì¹˜í•˜ëŠ” ì ì´ë‹¤.  

- Optional Catch All Routes
<img width="404" alt="image" src="https://user-images.githubusercontent.com/84058944/213976134-fb36e0b1-276f-4cdf-9555-e538c404464d.png">

<br><br>

- Catch All Routes
<img width="804" alt="image" src="https://user-images.githubusercontent.com/84058944/213976251-bcb4aaad-ae0d-48ae-b491-243279d6f85a.png">



<br><br>




### Shallow Routing
Shallow Routingì€ `getServerSideProps`, `getStaticProps` ë“±ì˜ ë©”ì†Œë“œë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•´ì„œ ìƒˆë¡­ê²Œ ë°ì´í„° íŒ¨ì¹­ì„ í•˜ì§€ ì•Šìœ¼ë©´ì„œ URLì„ ë³€ê²½í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.  
ì¦‰, í˜„ì¬ ìƒíƒœë¥¼ ìƒì§€ ì•Šê³  URLë§Œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.  

URLì„ ë³€ê²½í•˜ëŠ” ë°©ì‹ ëª‡ê°œë¥¼ ì‚´í´ë³´ì.  

* `location.replace('url')`

  -`pages/my-page/info.js` ì— ì•„ë˜ì™€ ê°™ì´ ì½”ë“œë¥¼ ì‘ì„±í–ˆë‹¤.   


```javascript
import { useRouter } from "next/router";
import { useState } from "react";

const Info = () => {
    const router = useRouter()
    const [clicked, setClicked] = useState(false);
    const {status = 'initial'} = router.query;
    
    return <>
    <h1>Info</h1>
    <h1>Clicked: {String(clicked)}</h1>
    <h1>Status: {status}</h1>
    <button onClick={
        ()=> {
            alert('clicked');
            setClicked(true);
            location.replace('/my-page/info?status=editing')
        }
    
    }>edit(location.replace)</button>
    </>
}

export default Info;
```

---
 
ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸í•´ë³´ì! ğŸ‘€  
- ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ alertì´ ëœ¬ë‹¤.
- Clicked: true ë¡œ ë³€ê²½ì´ ëœë‹¤.
- URLì´ `'/my-page/info?status=editing'` ë¡œ ë³€ê²½ë˜ë©´ì„œ clicked ê°’ì´ false ë¡œ ë‹¤ì‹œ ë³€ê²½ëœë‹¤.

ì¦‰, URLì„ ë³€ê²½í•˜ë©´ì„œ ë¦¬ë Œë”ê°€ ë°œìƒí–ˆê³ , ê¸°ì¡´ì˜ stateë¥¼ ìœ ì§€í•˜ì§€ ëª»í–ˆë‹¤.  

---

* `router.push(url)`
  - `pages/my-page/info.js` ì— ì•„ë˜ì™€ ê°™ì´ ì½”ë“œë¥¼ ì‘ì„±í–ˆë‹¤.   

```javascript
import { useRouter } from "next/router";
import { useState } from "react";

const Info = () => {
    const router = useRouter()
    const [clicked, setClicked] = useState(false);
    const {status = 'initial'} = router.query;
    
    return <>
    <h1>Info</h1>
    <h1>Clicked: {String(clicked)}</h1>
    <h1>Status: {status}</h1>
    <button onClick={
        ()=> {
            alert('clicked');
            setClicked(true);
            router.push('/my-page/info?status=editing')
        }
    
    }>edit(router.push)</button>
    </>
}

export default Info;
```

---

ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸í•´ë³´ì! ğŸ‘€  
- ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ alertì´ ëœ¬ë‹¤.
- Clicked: true ë¡œ ë³€ê²½ì´ ëœë‹¤.
- URLì´ `'/my-page/info?status=editing'` ë¡œ ë³€ê²½ë˜ì–´ë„ clicked  true ë¡œ ìœ ì§€ëœë‹¤.

---

`location.replace()` ë©”ì†Œë“œì™€, `router.push()` ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ë©´ì„œ `getServerSideProps` í•¨ìˆ˜ë„ í˜¸ì¶œí•´ë³´ì! 
```javascript
import { useRouter } from "next/router";
import { useState } from "react";

export async function getServerSideProps() {
    console.log('server-side');
    return {
        props: {}
    }
}

const Info = () => {
    const router = useRouter()
    const [clicked, setClicked] = useState(false);
    const {status = 'initial'} = router.query;
    
    return <>
    <h1>Info</h1>
    <h1>Clicked: {String(clicked)}</h1>
    <h1>Status: {status}</h1>
    

    <button onClick={
        ()=> {
            alert('clicked');
            setClicked(true);
            location.replace('/my-page/info?status=editing')
        }
    
    }>edit(location.replace)</button>

    <button onClick={
        ()=> {
            alert('clicked');
            setClicked(true);
            router.push('/my-page/info?status=editing')
        }
    
    }>edit(router.push)</button>
    </>
}

export default Info;
```
---

ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸í•´ë³´ì! ğŸ‘€  
- ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ alertì´ ëœ¬ë‹¤.
- Clicked: true ë¡œ ë³€ê²½ì´ ëœë‹¤.
- URLì´ `'/my-page/info?status=editing'` ë¡œ ë³€ê²½ë˜ì–´ë„ clicked  true ë¡œ ìœ ì§€ëœë‹¤.
- IDEì˜ í„°ë¯¸ë„ì— 'server-side'ê°€ ì°í˜”ë‹¤.  


ì´ëŠ” URLì´ ë³€ê²½ë˜ë©´ì„œ `getServerSideProps` í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ë©´ì„œ ìƒˆë¡œ ë°ì´í„°ë¥¼ íŒ¨ì¹­í–ˆë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.  

---

* `router.push(url, as, {shallow: true})`
  - `pages/my-page/info.js` ì— ì•„ë˜ì™€ ê°™ì´ ì½”ë“œë¥¼ ì‘ì„±í–ˆë‹¤.   


```javascript
import { useRouter } from "next/router";
import { useState } from "react";

export async function getServerSideProps() {
    console.log('server-side');
    return {
        props: {}
    }
}

const Info = () => {
    const router = useRouter()
    const [clicked, setClicked] = useState(false);
    const {status = 'initial'} = router.query;
    
    return <>
    <h1>Info</h1>
    <h1>Clicked: {String(clicked)}</h1>
    <h1>Status: {status}</h1>
    

    <button onClick={
        ()=> {
            alert('clicked');
            setClicked(true);
            location.replace('/my-page/info?status=editing')
        }
    
    }>edit(location.replace)</button>

    <button onClick={
        ()=> {
            alert('clicked');
            setClicked(true);
            router.push('/my-page/info?status=editing')
        }
    
    }>edit(router.push)</button>



<button onClick={
        ()=> {
            alert('clicked');
            setClicked(true);
            router.push('/my-page/info?status=editing', undefined, {shallow:true})
        }
    
    }>edit(router.push)</button>
    </>



}

export default Info;
```

--- 

ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸í•´ë³´ì! ğŸ‘€
- ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ alertì´ ëœ¬ë‹¤.
- Clicked: true ë¡œ ë³€ê²½ì´ ëœë‹¤.
- URLì´ `'/my-page/info?status=editing'` ë¡œ ë³€ê²½ë˜ì–´ë„ clicked  true ë¡œ ìœ ì§€ëœë‹¤.
- IDEì˜ í„°ë¯¸ë„ì— ì•„ë¬´ê²ƒë„ ê¸°ë¡ë˜ì§€ ì•Šì•˜ë‹¤.  

ì¦‰, ë¡œì»¬ stateì™€ ë°ì´í„° íŒ¨ì¹­ì´ ìœ ì§€ë˜ì—ˆë‹¤.  
ë”°ë¼ì„œ, ë¡œì»¬ stateì„ ìœ ì§€í•˜ê³ , ë°ì´í„° íŒ¨ì¹­ì´ ìƒˆë¡œ ë°œìƒí•˜ì§€ ì•Šìœ¼ë©´ì„œ, ê°™ì€ í˜ì´ì§€ ë‚´ì—ì„œ queryë§Œ ë³€ê²½í•˜ê³  ì‹¶ë‹¤ë©´ `Shallow Routing`ì„ ì‚¬ìš©í•  ìˆ˜ ìˆê² ë‹¤.  

---


> Next.js ì™„ì „ ì •ë³µ : í™•ì¥ì„± ë†’ì€ ì»¤ë¨¸ìŠ¤ ì„œë¹„ìŠ¤ êµ¬ì¶•í•˜ê¸°, ìµœì§€ë¯¼ ë‹˜ì˜ ê°•ì˜ë¥¼ ì°¸ê³ í•˜ì—¬ ì‘ì„±í•œ ê¸€ì…ë‹ˆë‹¤.
